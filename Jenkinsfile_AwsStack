 
pipeline{
  agent any
  stages{
  
  stage('Checking out code from release'){
     steps{
          checkout([$class: 'GitSCM', branches: [[name: '*/release']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[url: 'https://github.com/AditPinheiro/react-js-quick-food-delivery-website.git']]])
      }
    }
  
  
    stage('Creating AWS stack'){
      steps{
        echo "Creating aws cloudforamtion stack"
        withCredentials([[$class: 'AmazonWebServicesCredentialsBinding', accessKeyVariable: '', credentialsId: 'aws-key', secretKeyVariable: '']]) {
          
sh 'aws cloudformation create-stack --stack-name foodapp-release --template-body file://foodapp_template.yaml --region us-east-1 --parameters ParameterKey=SSHKey,ParameterValue=aditpinheiro_ubuntu ParameterKey=ELBVPC,ParameterValue=vpc-2bbabd51 ParameterKey=ELBSubnet,ParameterValue="subnet-3e35c261\\,subnet-836bd1ce"'

        
        }
        
      }
    }
    
    
  }
}
